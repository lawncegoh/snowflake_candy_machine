{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.array = exports.rustEnum = exports.str = exports.vecU8 = exports.tagged = exports.vec = exports.bool = exports.option = exports.publicKey = exports.i128 = exports.u128 = exports.i64 = exports.u64 = exports.struct = exports.i32 = exports.u32 = exports.i16 = exports.u16 = exports.i8 = exports.u8 = void 0;\n\nconst buffer_layout_1 = require(\"buffer-layout\");\n\nconst web3_js_1 = require(\"@solana/web3.js\");\n\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\n\nvar buffer_layout_2 = require(\"buffer-layout\");\n\nObject.defineProperty(exports, \"u8\", {\n  enumerable: true,\n  get: function () {\n    return buffer_layout_2.u8;\n  }\n});\nObject.defineProperty(exports, \"i8\", {\n  enumerable: true,\n  get: function () {\n    return buffer_layout_2.s8;\n  }\n});\nObject.defineProperty(exports, \"u16\", {\n  enumerable: true,\n  get: function () {\n    return buffer_layout_2.u16;\n  }\n});\nObject.defineProperty(exports, \"i16\", {\n  enumerable: true,\n  get: function () {\n    return buffer_layout_2.s16;\n  }\n});\nObject.defineProperty(exports, \"u32\", {\n  enumerable: true,\n  get: function () {\n    return buffer_layout_2.u32;\n  }\n});\nObject.defineProperty(exports, \"i32\", {\n  enumerable: true,\n  get: function () {\n    return buffer_layout_2.s32;\n  }\n});\nObject.defineProperty(exports, \"struct\", {\n  enumerable: true,\n  get: function () {\n    return buffer_layout_2.struct;\n  }\n});\n\nclass BNLayout extends buffer_layout_1.Layout {\n  constructor(span, signed, property) {\n    super(span, property);\n    this.blob = buffer_layout_1.blob(span);\n    this.signed = signed;\n  }\n\n  decode(b, offset = 0) {\n    const num = new bn_js_1.default(this.blob.decode(b, offset), 10, 'le');\n\n    if (this.signed) {\n      return num.fromTwos(this.span * 8).clone();\n    }\n\n    return num;\n  }\n\n  encode(src, b, offset = 0) {\n    if (this.signed) {\n      src = src.toTwos(this.span * 8);\n    }\n\n    return this.blob.encode(src.toArrayLike(Buffer, 'le', this.span), b, offset);\n  }\n\n}\n\nfunction u64(property) {\n  return new BNLayout(8, false, property);\n}\n\nexports.u64 = u64;\n\nfunction i64(property) {\n  return new BNLayout(8, true, property);\n}\n\nexports.i64 = i64;\n\nfunction u128(property) {\n  return new BNLayout(16, false, property);\n}\n\nexports.u128 = u128;\n\nfunction i128(property) {\n  return new BNLayout(16, true, property);\n}\n\nexports.i128 = i128;\n\nclass WrappedLayout extends buffer_layout_1.Layout {\n  constructor(layout, decoder, encoder, property) {\n    super(layout.span, property);\n    this.layout = layout;\n    this.decoder = decoder;\n    this.encoder = encoder;\n  }\n\n  decode(b, offset) {\n    return this.decoder(this.layout.decode(b, offset));\n  }\n\n  encode(src, b, offset) {\n    return this.layout.encode(this.encoder(src), b, offset);\n  }\n\n  getSpan(b, offset) {\n    return this.layout.getSpan(b, offset);\n  }\n\n}\n\nfunction publicKey(property) {\n  return new WrappedLayout(buffer_layout_1.blob(32), b => new web3_js_1.PublicKey(b), key => key.toBuffer(), property);\n}\n\nexports.publicKey = publicKey;\n\nclass OptionLayout extends buffer_layout_1.Layout {\n  constructor(layout, property) {\n    super(-1, property);\n    this.layout = layout;\n    this.discriminator = buffer_layout_1.u8();\n  }\n\n  encode(src, b, offset = 0) {\n    if (src === null || src === undefined) {\n      return this.discriminator.encode(0, b, offset);\n    }\n\n    this.discriminator.encode(1, b, offset);\n    return this.layout.encode(src, b, offset + 1) + 1;\n  }\n\n  decode(b, offset = 0) {\n    const discriminator = this.discriminator.decode(b, offset);\n\n    if (discriminator === 0) {\n      return null;\n    } else if (discriminator === 1) {\n      return this.layout.decode(b, offset + 1);\n    }\n\n    throw new Error('Invalid option ' + this.property);\n  }\n\n  getSpan(b, offset = 0) {\n    const discriminator = this.discriminator.decode(b, offset);\n\n    if (discriminator === 0) {\n      return 1;\n    } else if (discriminator === 1) {\n      return this.layout.getSpan(b, offset + 1) + 1;\n    }\n\n    throw new Error('Invalid option ' + this.property);\n  }\n\n}\n\nfunction option(layout, property) {\n  return new OptionLayout(layout, property);\n}\n\nexports.option = option;\n\nfunction bool(property) {\n  return new WrappedLayout(buffer_layout_1.u8(), decodeBool, encodeBool, property);\n}\n\nexports.bool = bool;\n\nfunction decodeBool(value) {\n  if (value === 0) {\n    return false;\n  } else if (value === 1) {\n    return true;\n  }\n\n  throw new Error('Invalid bool: ' + value);\n}\n\nfunction encodeBool(value) {\n  return value ? 1 : 0;\n}\n\nfunction vec(elementLayout, property) {\n  const length = buffer_layout_1.u32('length');\n  const layout = buffer_layout_1.struct([length, buffer_layout_1.seq(elementLayout, buffer_layout_1.offset(length, -length.span), 'values')]);\n  return new WrappedLayout(layout, ({\n    values\n  }) => values, values => ({\n    values\n  }), property);\n}\n\nexports.vec = vec;\n\nfunction tagged(tag, layout, property) {\n  const wrappedLayout = buffer_layout_1.struct([u64('tag'), layout.replicate('data')]);\n\n  function decodeTag({\n    tag: receivedTag,\n    data\n  }) {\n    if (!receivedTag.eq(tag)) {\n      throw new Error('Invalid tag, expected: ' + tag.toString('hex') + ', got: ' + receivedTag.toString('hex'));\n    }\n\n    return data;\n  }\n\n  return new WrappedLayout(wrappedLayout, decodeTag, data => ({\n    tag,\n    data\n  }), property);\n}\n\nexports.tagged = tagged;\n\nfunction vecU8(property) {\n  const length = buffer_layout_1.u32('length');\n  const layout = buffer_layout_1.struct([length, buffer_layout_1.blob(buffer_layout_1.offset(length, -length.span), 'data')]);\n  return new WrappedLayout(layout, ({\n    data\n  }) => data, data => ({\n    data\n  }), property);\n}\n\nexports.vecU8 = vecU8;\n\nfunction str(property) {\n  return new WrappedLayout(vecU8(), data => data.toString('utf-8'), s => Buffer.from(s, 'utf-8'), property);\n}\n\nexports.str = str;\n\nfunction rustEnum(variants, property) {\n  const unionLayout = buffer_layout_1.union(buffer_layout_1.u8(), property);\n  variants.forEach((variant, index) => unionLayout.addVariant(index, variant, variant.property));\n  return unionLayout;\n}\n\nexports.rustEnum = rustEnum;\n\nfunction array(elementLayout, length, property) {\n  const layout = buffer_layout_1.struct([buffer_layout_1.seq(elementLayout, length, 'values')]);\n  return new WrappedLayout(layout, ({\n    values\n  }) => values, values => ({\n    values\n  }), property);\n}\n\nexports.array = array;","map":{"version":3,"sources":["../../src/index.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.array = exports.rustEnum = exports.str = exports.vecU8 = exports.tagged = exports.vec = exports.bool = exports.option = exports.publicKey = exports.i128 = exports.u128 = exports.i64 = exports.u64 = exports.struct = exports.i32 = exports.u32 = exports.i16 = exports.u16 = exports.i8 = exports.u8 = void 0;\r\nconst buffer_layout_1 = require(\"buffer-layout\");\r\nconst web3_js_1 = require(\"@solana/web3.js\");\r\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\r\nvar buffer_layout_2 = require(\"buffer-layout\");\r\nObject.defineProperty(exports, \"u8\", { enumerable: true, get: function () { return buffer_layout_2.u8; } });\r\nObject.defineProperty(exports, \"i8\", { enumerable: true, get: function () { return buffer_layout_2.s8; } });\r\nObject.defineProperty(exports, \"u16\", { enumerable: true, get: function () { return buffer_layout_2.u16; } });\r\nObject.defineProperty(exports, \"i16\", { enumerable: true, get: function () { return buffer_layout_2.s16; } });\r\nObject.defineProperty(exports, \"u32\", { enumerable: true, get: function () { return buffer_layout_2.u32; } });\r\nObject.defineProperty(exports, \"i32\", { enumerable: true, get: function () { return buffer_layout_2.s32; } });\r\nObject.defineProperty(exports, \"struct\", { enumerable: true, get: function () { return buffer_layout_2.struct; } });\r\nclass BNLayout extends buffer_layout_1.Layout {\r\n    constructor(span, signed, property) {\r\n        super(span, property);\r\n        this.blob = buffer_layout_1.blob(span);\r\n        this.signed = signed;\r\n    }\r\n    decode(b, offset = 0) {\r\n        const num = new bn_js_1.default(this.blob.decode(b, offset), 10, 'le');\r\n        if (this.signed) {\r\n            return num.fromTwos(this.span * 8).clone();\r\n        }\r\n        return num;\r\n    }\r\n    encode(src, b, offset = 0) {\r\n        if (this.signed) {\r\n            src = src.toTwos(this.span * 8);\r\n        }\r\n        return this.blob.encode(src.toArrayLike(Buffer, 'le', this.span), b, offset);\r\n    }\r\n}\r\nfunction u64(property) {\r\n    return new BNLayout(8, false, property);\r\n}\r\nexports.u64 = u64;\r\nfunction i64(property) {\r\n    return new BNLayout(8, true, property);\r\n}\r\nexports.i64 = i64;\r\nfunction u128(property) {\r\n    return new BNLayout(16, false, property);\r\n}\r\nexports.u128 = u128;\r\nfunction i128(property) {\r\n    return new BNLayout(16, true, property);\r\n}\r\nexports.i128 = i128;\r\nclass WrappedLayout extends buffer_layout_1.Layout {\r\n    constructor(layout, decoder, encoder, property) {\r\n        super(layout.span, property);\r\n        this.layout = layout;\r\n        this.decoder = decoder;\r\n        this.encoder = encoder;\r\n    }\r\n    decode(b, offset) {\r\n        return this.decoder(this.layout.decode(b, offset));\r\n    }\r\n    encode(src, b, offset) {\r\n        return this.layout.encode(this.encoder(src), b, offset);\r\n    }\r\n    getSpan(b, offset) {\r\n        return this.layout.getSpan(b, offset);\r\n    }\r\n}\r\nfunction publicKey(property) {\r\n    return new WrappedLayout(buffer_layout_1.blob(32), (b) => new web3_js_1.PublicKey(b), (key) => key.toBuffer(), property);\r\n}\r\nexports.publicKey = publicKey;\r\nclass OptionLayout extends buffer_layout_1.Layout {\r\n    constructor(layout, property) {\r\n        super(-1, property);\r\n        this.layout = layout;\r\n        this.discriminator = buffer_layout_1.u8();\r\n    }\r\n    encode(src, b, offset = 0) {\r\n        if (src === null || src === undefined) {\r\n            return this.discriminator.encode(0, b, offset);\r\n        }\r\n        this.discriminator.encode(1, b, offset);\r\n        return this.layout.encode(src, b, offset + 1) + 1;\r\n    }\r\n    decode(b, offset = 0) {\r\n        const discriminator = this.discriminator.decode(b, offset);\r\n        if (discriminator === 0) {\r\n            return null;\r\n        }\r\n        else if (discriminator === 1) {\r\n            return this.layout.decode(b, offset + 1);\r\n        }\r\n        throw new Error('Invalid option ' + this.property);\r\n    }\r\n    getSpan(b, offset = 0) {\r\n        const discriminator = this.discriminator.decode(b, offset);\r\n        if (discriminator === 0) {\r\n            return 1;\r\n        }\r\n        else if (discriminator === 1) {\r\n            return this.layout.getSpan(b, offset + 1) + 1;\r\n        }\r\n        throw new Error('Invalid option ' + this.property);\r\n    }\r\n}\r\nfunction option(layout, property) {\r\n    return new OptionLayout(layout, property);\r\n}\r\nexports.option = option;\r\nfunction bool(property) {\r\n    return new WrappedLayout(buffer_layout_1.u8(), decodeBool, encodeBool, property);\r\n}\r\nexports.bool = bool;\r\nfunction decodeBool(value) {\r\n    if (value === 0) {\r\n        return false;\r\n    }\r\n    else if (value === 1) {\r\n        return true;\r\n    }\r\n    throw new Error('Invalid bool: ' + value);\r\n}\r\nfunction encodeBool(value) {\r\n    return value ? 1 : 0;\r\n}\r\nfunction vec(elementLayout, property) {\r\n    const length = buffer_layout_1.u32('length');\r\n    const layout = buffer_layout_1.struct([\r\n        length,\r\n        buffer_layout_1.seq(elementLayout, buffer_layout_1.offset(length, -length.span), 'values'),\r\n    ]);\r\n    return new WrappedLayout(layout, ({ values }) => values, values => ({ values }), property);\r\n}\r\nexports.vec = vec;\r\nfunction tagged(tag, layout, property) {\r\n    const wrappedLayout = buffer_layout_1.struct([\r\n        u64('tag'),\r\n        layout.replicate('data'),\r\n    ]);\r\n    function decodeTag({ tag: receivedTag, data }) {\r\n        if (!receivedTag.eq(tag)) {\r\n            throw new Error('Invalid tag, expected: ' +\r\n                tag.toString('hex') +\r\n                ', got: ' +\r\n                receivedTag.toString('hex'));\r\n        }\r\n        return data;\r\n    }\r\n    return new WrappedLayout(wrappedLayout, decodeTag, data => ({ tag, data }), property);\r\n}\r\nexports.tagged = tagged;\r\nfunction vecU8(property) {\r\n    const length = buffer_layout_1.u32('length');\r\n    const layout = buffer_layout_1.struct([\r\n        length,\r\n        buffer_layout_1.blob(buffer_layout_1.offset(length, -length.span), 'data'),\r\n    ]);\r\n    return new WrappedLayout(layout, ({ data }) => data, data => ({ data }), property);\r\n}\r\nexports.vecU8 = vecU8;\r\nfunction str(property) {\r\n    return new WrappedLayout(vecU8(), data => data.toString('utf-8'), s => Buffer.from(s, 'utf-8'), property);\r\n}\r\nexports.str = str;\r\nfunction rustEnum(variants, property) {\r\n    const unionLayout = buffer_layout_1.union(buffer_layout_1.u8(), property);\r\n    variants.forEach((variant, index) => unionLayout.addVariant(index, variant, variant.property));\r\n    return unionLayout;\r\n}\r\nexports.rustEnum = rustEnum;\r\nfunction array(elementLayout, length, property) {\r\n    const layout = buffer_layout_1.struct([\r\n        buffer_layout_1.seq(elementLayout, length, 'values'),\r\n    ]);\r\n    return new WrappedLayout(layout, ({ values }) => values, values => ({ values }), property);\r\n}\r\nexports.array = array;\r\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"script"}