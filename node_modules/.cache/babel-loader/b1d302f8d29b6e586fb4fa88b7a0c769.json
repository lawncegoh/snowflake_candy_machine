{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BaseMessageSignerWalletAdapter = exports.BaseSignerWalletAdapter = void 0;\n\nconst adapter_1 = require(\"./adapter\");\n\nconst errors_1 = require(\"./errors\");\n\nclass BaseSignerWalletAdapter extends adapter_1.BaseWalletAdapter {\n  sendTransaction(transaction, connection, options = {}) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        try {\n          transaction.feePayer || (transaction.feePayer = this.publicKey || undefined);\n          transaction.recentBlockhash || (transaction.recentBlockhash = (yield connection.getRecentBlockhash('finalized')).blockhash);\n\n          const {\n            signers\n          } = options,\n                sendOptions = __rest(options, [\"signers\"]);\n\n          (signers === null || signers === void 0 ? void 0 : signers.length) && transaction.partialSign(...signers);\n          transaction = yield this.signTransaction(transaction);\n          const rawTransaction = transaction.serialize();\n          return yield connection.sendRawTransaction(rawTransaction, sendOptions);\n        } catch (error) {\n          if (error instanceof errors_1.WalletError) throw error;\n          throw new errors_1.WalletSendTransactionError(error === null || error === void 0 ? void 0 : error.message, error);\n        }\n      } catch (error) {\n        this.emit('error', error);\n        throw error;\n      }\n    });\n  }\n\n}\n\nexports.BaseSignerWalletAdapter = BaseSignerWalletAdapter;\n\nclass BaseMessageSignerWalletAdapter extends BaseSignerWalletAdapter {}\n\nexports.BaseMessageSignerWalletAdapter = BaseMessageSignerWalletAdapter;","map":{"version":3,"sources":["../src/signer.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,MAAA,SAAA,GAAA,OAAA,CAAA,WAAA,CAAA;;AACA,MAAA,QAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AASA,MAAsB,uBAAtB,SAAsD,SAAA,CAAA,iBAAtD,CAAuE;AAC7D,EAAA,eAAe,CACjB,WADiB,EAEjB,UAFiB,EAGjB,OAAA,GAAkC,EAHjB,EAGmB;;AAEpC,UAAI;AACA,YAAI;AACA,UAAA,WAAW,CAAC,QAAZ,KAAA,WAAW,CAAC,QAAZ,GAAyB,KAAK,SAAL,IAAkB,SAA3C;AACA,UAAA,WAAW,CAAC,eAAZ,KAAA,WAAW,CAAC,eAAZ,GAAgC,CAAC,MAAM,UAAU,CAAC,kBAAX,CAA8B,WAA9B,CAAP,EAAmD,SAAnF;;AAEA,gBAAM;AAAE,YAAA;AAAF,cAA8B,OAApC;AAAA,gBAAoB,WAAW,GAAA,MAAA,CAAK,OAAL,EAAzB,CAAA,SAAA,CAAyB,CAA/B;;AAEA,WAAA,OAAO,KAAA,IAAP,IAAA,OAAO,KAAA,KAAA,CAAP,GAAO,KAAA,CAAP,GAAA,OAAO,CAAE,MAAT,KAAmB,WAAW,CAAC,WAAZ,CAAwB,GAAG,OAA3B,CAAnB;AAEA,UAAA,WAAW,GAAG,MAAM,KAAK,eAAL,CAAqB,WAArB,CAApB;AAEA,gBAAM,cAAc,GAAG,WAAW,CAAC,SAAZ,EAAvB;AAEA,iBAAO,MAAM,UAAU,CAAC,kBAAX,CAA8B,cAA9B,EAA8C,WAA9C,CAAb;AACH,SAbD,CAaE,OAAO,KAAP,EAAmB;AACjB,cAAI,KAAK,YAAY,QAAA,CAAA,WAArB,EAAkC,MAAM,KAAN;AAClC,gBAAM,IAAI,QAAA,CAAA,0BAAJ,CAA+B,KAAK,KAAA,IAAL,IAAA,KAAK,KAAA,KAAA,CAAL,GAAK,KAAA,CAAL,GAAA,KAAK,CAAE,OAAtC,EAA+C,KAA/C,CAAN;AACH;AACJ,OAlBD,CAkBE,OAAO,KAAP,EAAmB;AACjB,aAAK,IAAL,CAAU,OAAV,EAAmB,KAAnB;AACA,cAAM,KAAN;AACH;AACJ,K;AAAA;;AA5BkE;;AAAvE,OAAA,CAAA,uBAAA,GAAA,uBAAA;;AAwCA,MAAsB,8BAAtB,SACY,uBADZ,CACmC;;AADnC,OAAA,CAAA,8BAAA,GAAA,8BAAA","sourceRoot":"","sourcesContent":["\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BaseMessageSignerWalletAdapter = exports.BaseSignerWalletAdapter = void 0;\r\nconst adapter_1 = require(\"./adapter\");\r\nconst errors_1 = require(\"./errors\");\r\nclass BaseSignerWalletAdapter extends adapter_1.BaseWalletAdapter {\r\n    sendTransaction(transaction, connection, options = {}) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            try {\r\n                try {\r\n                    transaction.feePayer || (transaction.feePayer = this.publicKey || undefined);\r\n                    transaction.recentBlockhash || (transaction.recentBlockhash = (yield connection.getRecentBlockhash('finalized')).blockhash);\r\n                    const { signers } = options, sendOptions = __rest(options, [\"signers\"]);\r\n                    (signers === null || signers === void 0 ? void 0 : signers.length) && transaction.partialSign(...signers);\r\n                    transaction = yield this.signTransaction(transaction);\r\n                    const rawTransaction = transaction.serialize();\r\n                    return yield connection.sendRawTransaction(rawTransaction, sendOptions);\r\n                }\r\n                catch (error) {\r\n                    if (error instanceof errors_1.WalletError)\r\n                        throw error;\r\n                    throw new errors_1.WalletSendTransactionError(error === null || error === void 0 ? void 0 : error.message, error);\r\n                }\r\n            }\r\n            catch (error) {\r\n                this.emit('error', error);\r\n                throw error;\r\n            }\r\n        });\r\n    }\r\n}\r\nexports.BaseSignerWalletAdapter = BaseSignerWalletAdapter;\r\nclass BaseMessageSignerWalletAdapter extends BaseSignerWalletAdapter {\r\n}\r\nexports.BaseMessageSignerWalletAdapter = BaseMessageSignerWalletAdapter;\r\n//# sourceMappingURL=signer.js.map"]},"metadata":{},"sourceType":"script"}